import os

from Model.LoadData import dat_to_train_test, to_tf_dataset, rm_unlabelled_samples
from Model.MalwareDetection import MalwareDetection


if __name__ == '__main__':
	epochs = 10
	batch_size = 10

	# Create the instance of the MalwareDetection model
	model = MalwareDetection()

	# Get working directory and specify directory for getting .dat files
	wd = os.getcwd()
	wd = wd + '/ember'

	x_train, y_train, x_test, y_test = dat_to_train_test(wd)

	unfiltered_train_ds = to_tf_dataset(x_train, y_train)
	unfiltered_test_ds = to_tf_dataset(x_test, y_test)

	# Filter out the data with label '-1' (unlabeled)
	train_ds = rm_unlabelled_samples(unfiltered_train_ds)
	test_ds = rm_unlabelled_samples(unfiltered_test_ds)

	print(train_ds)
	print(test_ds)

	model.train()
