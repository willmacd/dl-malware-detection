from MalwareDetection import MalwareDetection
import LoadData
import os

def main():
	epochs = 10
	batch_size = 10

	# Create the instance of the MalwareDetection model
	model = MalwareDetection(epochs, batch_size)

	# Get working directory and specify directory for getting .dat files
	wd = os.getcwd()
	wd = wd+'/ember'

	x_train, y_train, x_test, y_test = LoadData.dat_to_train_test(wd)

	unfiltered_train_ds = LoadData.to_tf_dataset(x_train, y_train)
	unfiltered_test_ds = LoadData.to_tf_dataset(x_test, y_test)

	# Filter out the data with label '-1' (unlabeled)
	train_ds = LoadData.rm_unlabelled_samples(unfiltered_train_ds)
	test_ds = LoadData.rm_unlabelled_samples(unfiltered_test_ds)

	print(train_ds)
	print(test_ds)

	model.train()

if __name__ == '__main__':
    main()
