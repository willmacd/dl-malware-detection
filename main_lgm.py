from Model.LightGBM_Booster import LightGBM_Booster
from DataProcessing.LoadData import dat_to_train_test
import ember
import numpy as np

DATA_DIR = './Data/dat/'

def main():
    model = LightGBM_Booster()
    print("Model Initialized...")

    dataset = model.create_training_dataset(DATA_DIR)
    print("Dataset Created...")

    print("Model Begin Training...")
    model.train(dataset)
    print()

    x_train, y_train, x_test, y_test = dat_to_train_test(DATA_DIR)

    train_accuracy, train_length = model.evaluate_dataset_accuracy(x_train, y_train)
    print("Correct prediction on Train = " + str(train_accuracy))
    print("Accuracy on train  = " + str((train_accuracy/train_length)*100) + "%")
    test_accuracy, test_length = model.evaluate_dataset_accuracy(x_test, y_test)
    print("Correct prediction on Train = " + str(test_accuracy))
    print("Accuracy on train  = " + str((test_accuracy/test_length)*100) + "%")

if __name__ == '__main__':
    main()
