from MalwareDetection import MalwareDetection
import LoadData

def main():
	epochs = 10
	batch_size = 10

	model = MalwareDetection(epochs, batch_size)


	
	x_train, y_train, x_test, y_test = LoadData.dat_to_train_test('./ember')
	unfiltered_train_ds = LoadData.to_tf_dataset(x_train, y_train)
	unfiltered_test_ds = LoadData.to_tf_dataset(x_test, y_test)
	train_ds = LoadData.rm_unlabelled_samples(unfiltered_train_ds)
	test_ds = LoadData.rm_unlabelled_samples(unfiltered_test_ds)
	print(train_ds)

	model.train()

if __name__ == '__main__':
    main()
